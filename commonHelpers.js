import{g as i,r as s,s as d,m as O}from"./assets/markupBuyLinks-bc5117fd.js";import{i as b,a as q}from"./assets/vendor-8cce9181.js";document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("scrollUpButton");window.addEventListener("scroll",function(){window.scrollY>100?t.style.display="block":t.style.display="none"}),t.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})})});const k={titleColor:"#FFFFFF",messageColor:"#FFFFFF",messageSize:"20px",position:"topRight",displayMode:"replace",closeOnEscape:!0,pauseOnHover:!1,maxWidth:432,messageSize:"20px",messageLineHeight:"24px"};function L(t){b.show({message:t,backgroundColor:"#EF4040",progressBarColor:"#FFE0AC",...k})}function H(t){b.show({message:t,backgroundColor:"#3db919",progressBarColor:"#FFE0AC",...k})}const j="https://books-backend.p.goit.global",_=1e3*30,u=q.create({baseURL:j,timeout:_});function D(t){return L(t.message),null}u.interceptors.response.use(t=>t,D);function U(){return u.get("/books/category-list").then(t=>t.data)}function W(){return u.get("/books/top-books").then(t=>t.data)}function R(t){return u.get("/books/category",{params:{category:t}}).then(e=>e.data)}function V(t){return u.get(`/books/${t}`).then(e=>e.data)}const n={ulCategoryContainer:document.querySelector("#listContainer"),gallery:document.querySelector(".js-gallery"),loader:document.querySelector(".load-div"),btnAllCategories:document.querySelector('button[data-category="All categories"]'),modalWrapper:document.querySelector(".js-modal-wrapper"),modalImg:document.querySelector(".js-modal-img"),modalTitle:document.querySelector(".js-modal-title"),modalDescription:document.querySelector(".js-modal-description"),modalText:document.querySelector(".js-modal-text"),modalLinks:document.querySelector(".js-modal-links-icon"),modalBtn:document.querySelector(".js-modal-btn"),modalCongratulation:document.querySelector(".js-modal-congratulation"),modalClose:document.querySelector(".js-icon-close")},{categoryName:z}=s;function G({list_name:t}){return`<li class="item-category"> <button class="${i(z)===t?"active":""}" type="button" data-category="${t}">${t}</button></li>`}const{ulCategoryContainer:g}=n,{categoryName:P}=s;function h(){const t=i(P),e=document.querySelector(`button[data-category="${t}"]`);e&&g&&(g.scrollTop=e.offsetTop-g.offsetTop-g.clientHeight/2+e.clientHeight/2)}async function X(){try{const e=(await U()).map(G).join("");n.ulCategoryContainer.insertAdjacentHTML("beforeend",e),h()}catch(t){console.error("Error rendering Category list",t)}}X();function K(t){const o=t.split(" ");let a="",r=0;for(const c of o){const l=c.length;if(r+l+1>20){a+="...";break}a+=c+" ",r+=l+1}return a.trim()}function E(t){const{_id:e,book_image:o,title:a,author:r}=t;return`
<li class="books-item" data-id=${e}>
<div class="book-wrapper">
 <img class="book-image" src="${o}" alt="${r} ${a}" />
          <p class="book-image-message-text">QUICK VIEW</p>
</div>
        <h2 class="book-title">${K(a)}</h2>
        <p class="book-author">${r}</p>
</li>     
  `}function T(t){const e=t.split(" "),o=`<span>${e.pop()}</span>`;e.push(o);const a=document.createElement("h1");return a.classList.add("title"),a.innerHTML=e.join(" "),a}function Q(t){const e=i(s.booksInCart);return!e||!e.length?!1:e.some(o=>o._id===t)}const p="add",v="remove",B="is-open",C="hidden",w="add to shopping list",S="remove from the shopping list",{modalWrapper:Y,modalImg:J,modalTitle:Z,modalDescription:tt,modalText:et,modalLinks:ot,modalBtn:y,modalCongratulation:at}=n;async function nt(t){document.body.style.overflow="hidden";const e=await V(t);if(!e){document.body.style.overflow="";return}d(s.categoryOpenInModal,e);const{_id:o,book_image:a,description:r,author:c,title:l,buy_links:F}=e,m=Q(o);ot.innerHTML=O(F),Z.textContent=l,tt.textContent=c,et.textContent=r,J.src=a,y.textContent=m?S:w,y.dataset.id=o,y.setAttribute("data-type",m?v:p),Y.classList.add(B),m&&at.classList.remove(C)}function N(t){if(t.target===t.currentTarget)return;const e=t.target.dataset.id||t.target.closest("li[data-id]").dataset.id;nt(e)}function A(t){t.innerHTML='<div class="load-div"><span class="loader"></span></div>'}async function f(t){try{A(n.gallery);const e=await R(t);n.gallery.innerHTML="";const o=T(t);n.gallery.appendChild(o);const a=document.createElement("ul");a.classList.add("selected-category-list"),n.gallery.appendChild(a);const r=e.map(c=>E(c)).join("");a.innerHTML=r,a.addEventListener("click",N)}catch{L("Error rendering category. Please try again later.")}}function x(){document.querySelectorAll("button[data-category]").forEach(e=>e.classList.remove("active"))}function M(){window.innerWidth>=1422?window.scrollTo({top:0,behavior:"smooth"}):(n.gallery.style.minHeight=window.innerHeight+"px",n.gallery.scrollIntoView({behavior:"smooth",block:"start"}))}function rt(t){M();const e=t.target.dataset.category,o=document.querySelector(`.item-category button[data-category="${e}"]`);x(),o.classList.add("active"),d(s.categoryName,e),f(e),h()}function st({list_name:t,books:e}){const o=document.createElement("li");o.classList.add("category-books-item");const a=document.createElement("h3");a.classList.add("category-title"),a.textContent=t;const r=document.createElement("ul");r.classList.add("category-list"),r.innerHTML=e.map(E).join(""),r.addEventListener("click",N);const c=document.createElement("div");c.classList.add("category-div");const l=document.createElement("button");return l.classList.add("category-button"),l.setAttribute("type","button"),l.setAttribute("data-category",t),l.textContent="SEE MORE",l.addEventListener("click",rt),o.append(a),o.append(r),o.append(c),c.append(l),o}async function I(){A(n.gallery);const t=await W();if(t&&t.length>0){n.gallery.innerHTML="";const e=t.map(st),o=document.createElement("ul");o.classList.add("category-books-list"),o.append(...e),n.gallery.append(T("Best Sellers Books")),n.gallery.append(o)}else console.error("No results")}const{categoryName:lt}=s;function ct(t){if(t.target.nodeName!=="BUTTON")return;x(),t.target.classList.add("active"),M();const e=t.target.getAttribute("data-category");d(lt,e),e==="All categories"?I():f(e)}function it(t){let e=i(s.booksInCart);if(e===null)return;const o=e.filter(a=>a._id!==t);d(s.booksInCart,o),console.log(`The book with id ${t} was remove from cart`)}function dt(t){let e=i(s.booksInCart);if(e===null)e=[t];else if(e.some(a=>a._id===t._id)){console.log("This book already exists in your Cart!");return}else e.push(t);d(s.booksInCart,e),H("The book was successfully written to Cart!")}function ut(t){const{type:e,id:o}=t.target.dataset;e===p?(dt(i(s.categoryOpenInModal)),t.target.setAttribute("data-type",v),t.target.textContent=S,n.modalCongratulation.classList.remove(C)):(it(o),t.target.setAttribute("data-type",p),t.target.textContent=w,n.modalCongratulation.classList.add(C))}function $(t){t.target===t.currentTarget&&(document.body.style.overflow="",n.modalWrapper.classList.remove(B))}const{categoryName:gt}=s,{btnAllCategories:mt}=n;function yt(){const t=i(gt);t===null||t==="All categories"?(mt.classList.add("active"),I()):f(t)}const{ulCategoryContainer:pt,modalBtn:Ct,modalClose:ft,modalWrapper:bt}=n;document.addEventListener("DOMContentLoaded",yt);pt.addEventListener("click",ct);Ct.addEventListener("click",ut);ft.addEventListener("click",$);bt.addEventListener("click",$);
//# sourceMappingURL=commonHelpers.js.map
